<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Doxygen Awesome" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<meta property="og:url" content="https://jothepro.github.io/doxygen-awesome-css/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta name="twitter:title" content="Doxygen Awesome" />
<meta name="twitter:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<!-- END twitter metadata -->
<title>Hermes: CUDA</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!--<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>-->
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<!--<a href="https://github.com/jothepro/doxygen-awesome-css" class="github-corner" title="View source on GitHub">-->
<!--    <svg viewBox="0 0 250 250" style="position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">-->
<!--    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>-->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Hermes
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_docs_29__cuda.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">CUDA</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md42"></a> Hermes defines some macros to help you distinguish device code from host code. </p><div class="fragment"><div class="line"><span class="preprocessor">#define HERMES_HOST_FUNCTION __host__</span></div>
<div class="line"><span class="preprocessor">#define HERMES_DEVICE_CALLABLE __device__ __host__</span></div>
<div class="line"><span class="preprocessor">#define HERMES_DEVICE_FUNCTION __device__</span></div>
<div class="line"><span class="comment">// you can check if there is CUDA support with:</span></div>
<div class="line"><span class="preprocessor">#define HERMES_DEVICE_ENABLED</span></div>
<div class="line"><span class="comment">// Wraps a block of code that gets compiled only when using CUDA</span></div>
<div class="line"><span class="preprocessor">#define HERMES_CUDA_CODE(CODE) {CODE}</span></div>
</div><!-- fragment --> <blockquote class="doxtable">
<p>&zwj;When you build <code>hermes</code> without <code>CUDA</code> support, all macros listed in this section get empty or are simply not defined. </p>
</blockquote>
<p>An important tip to make sure a piece of code runs only in device is to use the following preprocessor condition: </p><div class="fragment"><div class="line"><span class="preprocessor">#if (defined(__CUDA_ARCH__) &amp;&amp; (__CUDA_ARCH__ &gt; 0))</span></div>
<div class="line"><span class="comment">// this code runs only in device</span></div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="comment">// this code runs only in host </span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
</div><!-- fragment --><p>Here is how you can declare a <code>CUDA</code> kernel: </p><div class="fragment"><div class="line"><span class="comment">// this macro creates a kernel called my_kernel_k</span></div>
<div class="line"><a class="code hl_define" href="group__common.html#ga0cdc0182ec6123bc74f82d9dd21e6e1d">HERMES_CUDA_KERNEL</a>(my_kernel)(<span class="keywordtype">int</span> argument) {</div>
<div class="line">  <span class="comment">// kernel code   </span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__common_html_ga0cdc0182ec6123bc74f82d9dd21e6e1d"><div class="ttname"><a href="group__common.html#ga0cdc0182ec6123bc74f82d9dd21e6e1d">HERMES_CUDA_KERNEL</a></div><div class="ttdeci">#define HERMES_CUDA_KERNEL(NAME)</div><div class="ttdoc">Defines a CUDA kernel function.</div><div class="ttdef"><b>Definition</b> defs.h:53</div></div>
</div><!-- fragment --> <blockquote class="doxtable">
<p>&zwj;Note that the macro appends <code>_k</code> to your kernel's name </p>
</blockquote>
<p>Usually your kernel will use thread indices that can be 1-dimensional, 2-dimensional or 3-dimensional depending on you launch configurations. Here are some macros that create those indices for you: </p><div class="fragment"><div class="line"><span class="comment">// creates a u32 i containing the thread index</span></div>
<div class="line"><a class="code hl_define" href="group__common.html#ga609bcafb13ee429a59a0293a7865caf8">HERMES_CUDA_THREAD_INDEX_I</a>;</div>
<div class="line"><span class="comment">// creates a hermes::index2 ij containing the thread index</span></div>
<div class="line"><a class="code hl_define" href="group__common.html#ga4ef6fff657663b66f0d0f5e12ababcdb">HERMES_CUDA_THREAD_INDEX_IJ</a>;</div>
<div class="line"><span class="comment">// creates a hermes::index3 ijk containing the thread index</span></div>
<div class="line">HERMES_CUDA_THREAD_INDEX_IK;  </div>
<div class="line"><span class="comment">// sometimes you may want the thread to execute only if its index is less then a size:</span></div>
<div class="line"><a class="code hl_define" href="group__common.html#gaebebd1b8b054ad683d8285c02dedae50">HERMES_CUDA_THREAD_INDEX_I_LT</a>(BOUNDS);</div>
<div class="line"><a class="code hl_define" href="group__common.html#gafc15510e76fea2a72a33c16239bb042b">HERMES_CUDA_THREAD_INDEX_IJ_LT</a>(BOUNDS);</div>
<div class="line"><a class="code hl_define" href="group__common.html#ga4bf99862fa4007d991bf46f507b3264f">HERMES_CUDA_THREAD_INDEX_IJK_LT</a>(BOUNDS);</div>
<div class="line"><span class="comment">// if you want to define the index variable name, use:</span></div>
<div class="line"><a class="code hl_define" href="group__common.html#gadfa66b7f36fcbd95bbeed9b7cc324a37">HERMES_CUDA_THREAD_INDEX_LT</a>(I, BOUNDS);</div>
<div class="line"><a class="code hl_define" href="group__common.html#gafb618bb840410eb6f01e79fe657827c2">HERMES_CUDA_THREAD_INDEX2_LT</a>(IJ, BOUNDS);</div>
<div class="line"><a class="code hl_define" href="group__common.html#ga23f00d772be8060e66dde091871e159c">HERMES_CUDA_THREAD_INDEX3_LT</a>(IJK, BOUNDS);</div>
<div class="ttc" id="agroup__common_html_ga23f00d772be8060e66dde091871e159c"><div class="ttname"><a href="group__common.html#ga23f00d772be8060e66dde091871e159c">HERMES_CUDA_THREAD_INDEX3_LT</a></div><div class="ttdeci">#define HERMES_CUDA_THREAD_INDEX3_LT(IJK, BOUNDS)</div><div class="ttdoc">Creates a 3-dimensional index and tests it against bounds.</div><div class="ttdef"><b>Definition</b> cuda_utils.h:321</div></div>
<div class="ttc" id="agroup__common_html_ga4bf99862fa4007d991bf46f507b3264f"><div class="ttname"><a href="group__common.html#ga4bf99862fa4007d991bf46f507b3264f">HERMES_CUDA_THREAD_INDEX_IJK_LT</a></div><div class="ttdeci">#define HERMES_CUDA_THREAD_INDEX_IJK_LT(BOUNDS)</div><div class="ttdoc">Creates a 3-dimensional index variable ijk and tests it against bounds.</div><div class="ttdef"><b>Definition</b> cuda_utils.h:335</div></div>
<div class="ttc" id="agroup__common_html_ga4ef6fff657663b66f0d0f5e12ababcdb"><div class="ttname"><a href="group__common.html#ga4ef6fff657663b66f0d0f5e12ababcdb">HERMES_CUDA_THREAD_INDEX_IJ</a></div><div class="ttdeci">#define HERMES_CUDA_THREAD_INDEX_IJ</div><div class="ttdoc">Creates a 2-dimensional index based on current cuda thread index.</div><div class="ttdef"><b>Definition</b> cuda_utils.h:286</div></div>
<div class="ttc" id="agroup__common_html_ga609bcafb13ee429a59a0293a7865caf8"><div class="ttname"><a href="group__common.html#ga609bcafb13ee429a59a0293a7865caf8">HERMES_CUDA_THREAD_INDEX_I</a></div><div class="ttdeci">#define HERMES_CUDA_THREAD_INDEX_I</div><div class="ttdoc">Creates a 1-dimensional index based on current cuda thread index.</div><div class="ttdef"><b>Definition</b> cuda_utils.h:282</div></div>
<div class="ttc" id="agroup__common_html_gadfa66b7f36fcbd95bbeed9b7cc324a37"><div class="ttname"><a href="group__common.html#gadfa66b7f36fcbd95bbeed9b7cc324a37">HERMES_CUDA_THREAD_INDEX_LT</a></div><div class="ttdeci">#define HERMES_CUDA_THREAD_INDEX_LT(I, BOUNDS)</div><div class="ttdoc">Creates a 1-dimensional index and tests it against bounds.</div><div class="ttdef"><b>Definition</b> cuda_utils.h:306</div></div>
<div class="ttc" id="agroup__common_html_gaebebd1b8b054ad683d8285c02dedae50"><div class="ttname"><a href="group__common.html#gaebebd1b8b054ad683d8285c02dedae50">HERMES_CUDA_THREAD_INDEX_I_LT</a></div><div class="ttdeci">#define HERMES_CUDA_THREAD_INDEX_I_LT(BOUNDS)</div><div class="ttdoc">Creates a 1-dimensional index variable i and tests it against bounds.</div><div class="ttdef"><b>Definition</b> cuda_utils.h:329</div></div>
<div class="ttc" id="agroup__common_html_gafb618bb840410eb6f01e79fe657827c2"><div class="ttname"><a href="group__common.html#gafb618bb840410eb6f01e79fe657827c2">HERMES_CUDA_THREAD_INDEX2_LT</a></div><div class="ttdeci">#define HERMES_CUDA_THREAD_INDEX2_LT(IJ, BOUNDS)</div><div class="ttdoc">Creates a 2-dimensional index and tests it against bounds.</div><div class="ttdef"><b>Definition</b> cuda_utils.h:313</div></div>
<div class="ttc" id="agroup__common_html_gafc15510e76fea2a72a33c16239bb042b"><div class="ttname"><a href="group__common.html#gafc15510e76fea2a72a33c16239bb042b">HERMES_CUDA_THREAD_INDEX_IJ_LT</a></div><div class="ttdeci">#define HERMES_CUDA_THREAD_INDEX_IJ_LT(BOUNDS)</div><div class="ttdoc">Creates a 2-dimensional index variable ij and tests it against bounds.</div><div class="ttdef"><b>Definition</b> cuda_utils.h:332</div></div>
</div><!-- fragment --><p> For debugging purposes, you may want to quickly make the first thread the only thread to execute, then you can use: </p><div class="fragment"><div class="line"><a class="code hl_define" href="group__common.html#gafc40680841ae084d7b06c3ace8871566">HERMES_CUDA_RETURN_IF_NOT_THREAD_0</a></div>
<div class="ttc" id="agroup__common_html_gafc40680841ae084d7b06c3ace8871566"><div class="ttname"><a href="group__common.html#gafc40680841ae084d7b06c3ace8871566">HERMES_CUDA_RETURN_IF_NOT_THREAD_0</a></div><div class="ttdeci">#define HERMES_CUDA_RETURN_IF_NOT_THREAD_0</div><div class="ttdoc">Ensures just thread of index 0 is run.</div><div class="ttdef"><b>Definition</b> cuda_utils.h:297</div></div>
</div><!-- fragment --><p> The most important thing you want to do is to check for errors, <code>hermes</code> lets you use: </p><div class="fragment"><div class="line"><span class="comment">// check CUDA function returns</span></div>
<div class="line"><a class="code hl_define" href="group__common.html#ga75561c2137a0fd59581d3698d9ffa0c4">HERMES_CHECK_CUDA_CALL</a>(err);</div>
<div class="line"><span class="comment">// for functions that do not return error codes or for kernel launches</span></div>
<div class="line"><span class="comment">// call it right after:</span></div>
<div class="line"><a class="code hl_define" href="group__common.html#ga6d0b9a59602d23ef75413ac258c1273e">HERMES_CHECK_LAST_CUDA_CALL</a> </div>
<div class="ttc" id="agroup__common_html_ga6d0b9a59602d23ef75413ac258c1273e"><div class="ttname"><a href="group__common.html#ga6d0b9a59602d23ef75413ac258c1273e">HERMES_CHECK_LAST_CUDA_CALL</a></div><div class="ttdeci">#define HERMES_CHECK_LAST_CUDA_CALL</div><div class="ttdoc">Checks (and logs) the last CUDA call for errors.</div><div class="ttdef"><b>Definition</b> cuda_utils.h:351</div></div>
<div class="ttc" id="agroup__common_html_ga75561c2137a0fd59581d3698d9ffa0c4"><div class="ttname"><a href="group__common.html#ga75561c2137a0fd59581d3698d9ffa0c4">HERMES_CHECK_CUDA_CALL</a></div><div class="ttdeci">#define HERMES_CHECK_CUDA_CALL(err)</div><div class="ttdoc">Checks (and logs) a CUDA method return code for errors.</div><div class="ttdef"><b>Definition</b> cuda_utils.h:341</div></div>
</div><!-- fragment --><p> When launching kernels, <code><a class="el" href="structhermes_1_1cuda__utils_1_1LaunchInfo.html" title="Holds CUDA launch parameters.">hermes::cuda_utils::LaunchInfo</a></code> holds launch information such as number of threads, blocks, shared memory size and stream. It also redistributes threads for you trying to optimize occupancy. The following macro can be used to launch kernels: </p><div class="fragment"><div class="line"><a class="code hl_define" href="group__common.html#ga160960b00f95a612a175ff2b070bf43a">HERMES_CUDA_LAUNCH_AND_SYNC</a>(LAUNCH_INFO, NAME, ...);</div>
<div class="ttc" id="agroup__common_html_ga160960b00f95a612a175ff2b070bf43a"><div class="ttname"><a href="group__common.html#ga160960b00f95a612a175ff2b070bf43a">HERMES_CUDA_LAUNCH_AND_SYNC</a></div><div class="ttdeci">#define HERMES_CUDA_LAUNCH_AND_SYNC(LAUNCH_INFO, NAME,...)</div><div class="ttdoc">Launches a CUDA kernel given its parameters and synchronizes with host.</div><div class="ttdef"><b>Definition</b> cuda_utils.h:273</div></div>
</div><!-- fragment --><p> In this case, LAUNCH_INFO is the constructor parameters, surrounded by <code>()</code>, of <code><a class="el" href="structhermes_1_1cuda__utils_1_1LaunchInfo.html" title="Holds CUDA launch parameters.">hermes::cuda_utils::LaunchInfo</a></code>. Here is a complete example: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cuda__utils_8h.html">hermes/common/cuda_utils.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// A kernel that stores in c, the sum of a and b</span></div>
<div class="line"><span class="comment">// All vectors have n elements</span></div>
<div class="line"><a class="code hl_define" href="group__common.html#ga0cdc0182ec6123bc74f82d9dd21e6e1d">HERMES_CUDA_KERNEL</a>(sum)(<span class="keywordtype">size_t</span> n, <span class="keywordtype">float</span>* a, <span class="keywordtype">float</span>* b, <span class="keywordtype">float</span>* c) {</div>
<div class="line">  <a class="code hl_define" href="group__common.html#gaebebd1b8b054ad683d8285c02dedae50">HERMES_CUDA_THREAD_INDEX_I_LT</a>(n);</div>
<div class="line">  c[i] = a[i] + b[i];</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">  <span class="comment">// lets create 3 arrays of size n</span></div>
<div class="line">  <span class="keywordtype">size_t</span> n = 1000;</div>
<div class="line">  std::vector&lt;float&gt; host_a(n), host_b(n), host_c(n, 0);</div>
<div class="line">  <span class="comment">// fill a and b with numbers</span></div>
<div class="line">  <span class="comment">// ...</span></div>
<div class="line">  <span class="comment">// lets now allocate memory in device</span></div>
<div class="line">  <span class="keywordtype">float</span> *device_a, *device_b, *device_c;</div>
<div class="line">  <a class="code hl_define" href="group__common.html#ga75561c2137a0fd59581d3698d9ffa0c4">HERMES_CHECK_CUDA_CALL</a>(cudaMalloc(&amp;device_a, n * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)));</div>
<div class="line">  <a class="code hl_define" href="group__common.html#ga75561c2137a0fd59581d3698d9ffa0c4">HERMES_CHECK_CUDA_CALL</a>(cudaMalloc(&amp;device_b, n * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)));</div>
<div class="line">  <a class="code hl_define" href="group__common.html#ga75561c2137a0fd59581d3698d9ffa0c4">HERMES_CHECK_CUDA_CALL</a>(cudaMalloc(&amp;device_c, n * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)));</div>
<div class="line">  <span class="comment">// now lets send the data to device</span></div>
<div class="line">  <a class="code hl_define" href="group__common.html#ga75561c2137a0fd59581d3698d9ffa0c4">HERMES_CHECK_CUDA_CALL</a>(cudaMemcpy(device_a, &amp;host_a[0], n * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), cudaMemcpyHostToDevice));</div>
<div class="line">  <a class="code hl_define" href="group__common.html#ga75561c2137a0fd59581d3698d9ffa0c4">HERMES_CHECK_CUDA_CALL</a>(cudaMemcpy(device_b, &amp;host_b[0], n * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), cudaMemcpyHostToDevice));</div>
<div class="line">  <a class="code hl_define" href="group__common.html#ga75561c2137a0fd59581d3698d9ffa0c4">HERMES_CHECK_CUDA_CALL</a>(cudaMemcpy(device_c, &amp;host_c[0], n * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), cudaMemcpyHostToDevice));</div>
<div class="line">  <span class="comment">// and finally call the kernel</span></div>
<div class="line">  <a class="code hl_define" href="group__common.html#ga160960b00f95a612a175ff2b070bf43a">HERMES_CUDA_LAUNCH_AND_SYNC</a>((n), sum_k, n, device_a, device_b, device_c);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="acuda__utils_8h_html"><div class="ttname"><a href="cuda__utils_8h.html">cuda_utils.h</a></div><div class="ttdoc">Auxiliary classes and macros for CUDA calls.</div></div>
</div><!-- fragment --> <blockquote class="doxtable">
<p>&zwj;Please check <a class="el" href="md_docs_210__storage.html">storage classes</a> for device arrays. </p>
</blockquote>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
<!--<script type="text/javascript">-->
<!--  $(function() {-->
<!--     toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')-->
<!--     toggleButton.title = "Toggle Light/Dark Mode"-->
<!---->
<!--     $(document).ready(function(){-->
<!--       document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)-->
<!--     })-->
<!--     $(window).resize(function(){-->
<!--       document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)-->
<!--     })-->
<!--   })-->
<!--</script>-->
</body>
</html>
